# -*- coding: utf-8 -*-
# -*- mode: org -*-

#+TITLE: Le g√©nie logiciel pour un ing√©nieur en /Machine Learning/
#+AUTHOR: K√©vin CAYE
#+LANGUAGE: fr

# reveal options: see https://github.com/yjwen/org-reveal
#+REVEAL_ROOT: file:/home/cayek/.src/reveal.js
#+REVEAL_TRANS: none
#+REVEAL_PLUGINS: (highlight notes)
#+OPTIONS: reveal_center:nil reveal_progress:t reveal_history:nil reveal_control:t
#+OPTIONS: reveal_rolling_links:t reveal_keyboard:t reveal_overview:t num:nil toc:nil
#+OPTIONS: reveal_width:1200 reveal_height:800
#+REVEAL_THEME: white
#+REVEAL_HLEVEL: 1 ## all header on same lvl
#+REVEAL_SPEED: fast
#+REVEAL_EXTRA_CSS: ./extra.css
#+REVEAL_EXTRA_JS: 

* TODO TODO                                                        :noexport:
Faire un peut en mode time line
- d√©finir science des donn√©es
- sorti de l'ensimag: git et c++
- th√®se: programmation fonctionnel
- prestation: mise en production par des web service
- present the service oriented Architechture: [[https://en.wikipedia.org/wiki/Service-oriented_architecture][wikipedia]] 
 - Pourquoi on fait ca dans l'√©quipe AAI (pr√©senter l'√©quipe AAI)
Expliquer √† chaque fois les notions: c'est quoi et √† quoi ca sert

Objectif: montrer les diff√©rents cas de figure que j'ai rencontrer pour dans mon
exp√©rience. Je ne veux pas etre exhaustif mais peut √™tre que mon exp√©rience
pourra vous aider dans des situations similaires.

Commencer par mon profile et mes attentes dans mon boulot. Pr√©senter mes
exp√©rience avec leur contexte, les probl√®mes et les solutions apport√©. point
cl√©e:
- d√©velopper des m√©thodes math√©matiques (stage fin d'√©tude)
  - premi√®re erreur: le c++ c'est super rapide dont je dev en c++. chercher √†
    optimiser trop t√¥t
  - j'it√®re sans faire de test: on sait rapidement plus ou on en ai ! M√™me quand
    on dev un prototype c'est pas pour de la production ! il faut faire des
    tests ! au moins sur le coeur algorithmique. Pas des test unitaires plut√¥t
    tester des situations.
- th√®ses: 
  - les model en data sciences
    - les donn√©es: id√©al avoir 3 niveaux model g√©n√©ratif, model simul√© mais plus
      compliqu√©, donn√©es r√©elles
  - la programmation en data science: fonctionnel
    - faire une comparaison d'un model impl√©ment√© en object et un en fonctionnel ?
  - La reproductibilit√© en science
- Schneider electric
  - devops
  - parler de ca: [[https://en.wikipedia.org/wiki/Cross-industry_standard_process_for_data_mining][Cross-industry standard process for data mining]]
  - parler de du TDD m√™me pour les explorations: see [[https://github.com/drivendataorg/power-laws-cold-start/tree/80d612b3ab881647f5a8b6a13960e81985630dc0/1st%2520Place/team-member-a-execute-first#start-of-the-challenge][power-laws-cold-start]]
  - organization: trouver ca facon de fonctionner: montrer mon workflow. Comment
    mes dossiers sont organis√© et les outils que j'utilise: git lfs pour les
    data + donn√©e intermediaire
- Remarques en vrac
  - la gestion du model est tr√®s importante ! 
  - avant c'est surtout les chercheurs qui avait des donn√©es
  - maintenant il y en a partout en industrie
  - la mesure de l'erreur est super important.
    - definir ce qu'on veut mesurer TODO
    - Pour ne pas se tromper il faut √™tre rigoureux ! Et donc organiser, comment
      decouper le dataset ?
  - parler du piege des notebooks ! et du manque de test unitaire en phase
    d'exploration. 
*Plan*
- Definition des data science et de l'ing√©nieur en datascience (proposer ma
  d√©finition), en particulier en industrie avec des examples. Donner aussi des
  exemples en science.
- Proposition d'un workflow.
- D√©finir les probl√©matiques de chaque √©tapes et apporter une proposition de
  solutions et les outils utilis√©.
- Conclusions et take away messages.

* Qui je suis ?
- Ancien Ensimag (promotion 2014)
- Th√®se en m√©thodes statistiques pour la g√©n√©tique
- Prestataire de service chez Kaizen Solution
* Plan et objectifs 

*Objectifs*

Comprendre les outils et m√©thodes de d√©veloppements utilis√©s en /Machine
Learning/.

*Plan*

1. Le paysage du /Machine Learning/
2. Comment mener un projet en /Machine Learning/

#+BEGIN_NOTES
1. Dans une premi√®re partie on va expliquer ce qu'est que le machine learning:
  - ou il est utilis√©
  - quelle sont les diff√©rentes branches
2. On verra comment un projet peut se d√©velopper du d√©but a la fin
   - ca sera l'occasion de voir les outils et m√©thode de travaille
#+END_NOTES
* 1. Le paysage du /machine learning/
:PROPERTIES:
:reveal_background: ./figures/wordle.png
:reveal_background_size: 1000px
:END:
** Qu'est ce que le /Machine Learning/ ?
*Approche traditionnel*
#+HTML: <img src="./figures/traditional_workflow.png" align="middle">

#+BEGIN_NOTES
Exemple: faire un filtre anti spam 
1. on annalyse les spam et on reparque que certain mots cl√©es: gratuit, carte de cr√©dit
2. on √©crit des filtre a la main pour chaque cas
3. on test et on r√©p√®te 
#+END_NOTES
** Qu'est ce que le /Machine Learning/ ?
*Approche /Machine Learning/*
#+HTML: <img src="./figures/ml_workflow.png" align="middle">

#+BEGIN_NOTES
Exemple: 
- on si on fait du machine learning l'algorithme qui detecte les spams va
  chercher a trouver automatiquement les r√®gles qui font qu'in spam est un spam
#+END_NOTES
** Pourquoi utiliser le /Machine Learning/ ?
*Le /machine Learning/ est parfait pour*

- les probl√®mes r√©solus en √©num√©rant un grand nombre de r√®gles
- les probl√®mes tr√®s complexes ou trouver toutes les r√®gles serait impossible
- les probl√®mes ou les r√®gles peuvent changer, ou il faut s'adapter √† de
  nouvelles donn√©es

*Exemples*

- filtre anti spam
- reconnaissance vocale
- d√©tection de fautes sur des machines industrielles

** Apprentissage supervis√©
*Un jeu de donn√©es labellis√©*
#+HTML: <img src="./figures/sup_ml0.png" align="middle">
** Apprentissage supervis√©
*R√©gression*
#+HTML: <img src="./figures/sup_ml1.png" align="middle">
** Apprentissage supervis√©
*Exemples d'algorithme*
- r√©gression lin√©aire
- arbres de d√©cision
- SVM (/Support Vector Machine/)
- r√©seaux de neurones
- et bien d'autres...
** Apprentissage non supervis√©
*Un jeu de donn√©es NON labellis√©*
#+HTML: <img src="./figures/unsup_ml0.png" align="middle">
** Apprentissage non supervis√©
*/Clustering/*
#+HTML: <img src="./figures/unsup_ml1.png" align="middle">
** Apprentissage non supervis√©
Quelques exemples d'algorithme: 

*/Clustering/*
- k-Means
*Visualisation et r√©duction de la dimension*
- Analyse en composant principale
*R√®gle d'association*
- Apriori
#+BEGIN_NOTES
L'id√©e sous jacente est de trouver une structure aux donn√©es, un moyen de les
repr√©senter pour:
- identifier des donn√©es annormals (outlier)
- d√©couvrir que les personnes qui ach√®te de la sauce barbecue et des chips ch√®te
  aussi en g√©n√©ral des steaks ü§ì. 
#+END_NOTES

** Apprentissage semi supervis√©
*Un jeu de donn√©es partiellement labellis√©*
#+HTML: <img src="./figures/semisup_ml0.png" align="middle">
#+BEGIN_NOTES
Exemple classique: 
- quand on charge ses photos sur google photo il reconna√Æt seul les m√™mes
  personnes sur les diff√©rentes photos (clustering).
- il suffit de labelliser une seul fois la personne sur une des photos pour que
  tout le groupe soit labellis√©.
#+END_NOTES
** Test et validation des algorithmes

*Mesure de la performance*
Par exemple l'erreur absolue moyenne:

$$ MAE = \frac{1}{n} \sum_{i =1}^{n} |Y_i - \hat{Y_i}| $$

*Donn√©es de validation*

Ce sont des donn√©es qui n'ont jamais √©t√© vu par les algorithmes, typiquement $20
\%$ des donn√©es.

*No Free Lunch Theorem ([[https://en.wikipedia.org/wiki/No_free_lunch_theorem][wikipedia]])*

Il n'y pas de mod√®le universelle, qui serait le meilleur tout le temps.

* 2. Comment mener un projet /Machine Learning/ ?

*Objectif* Pr√©dire le prix des quartiers en Californie.

#+BEGIN_NOTES
Le diable est dans les d√©tails donc je vais tacher de donner ces petit details
d'organisation qui peuvent faire gagner du temps.

On va voir les points cl√©es

#+END_NOTES
** Projet /Machine Learning/: principales √©tapes

1. Comprendre le probl√®me
2. Rassembler les donn√©es 
3. D√©couvrir et visualis√© les donn√©es
4. Cr√©er les mod√®les
5. D√©ployer le syst√®me

** Cr√©er un dossier de travaille et le versionner !! @@html:<img src="./figures/logo_git.png" width="110" height="46" alt="Git" style="border: 0;" />@@
:LOGBOOK:
- Note taken on [2019-01-04 ven. 11:33] \\
  https://blog.algorithmia.com/becoming-a-10x-data-scientist/#prod
:END:
- Cr√©er le projet
#+BEGIN_EXAMPLE
‚îú‚îÄ‚îÄ Makefile           <- Makefile with commands like `make data` or `make train`
‚îú‚îÄ‚îÄ README.md          <- The top-level README for developers using this project.
‚îú‚îÄ‚îÄ data
‚îÇ   ‚îú‚îÄ‚îÄ external       <- Data from third party sources.
‚îÇ   ‚îú‚îÄ‚îÄ interim        <- Intermediate data that has been transformed.
‚îÇ   ‚îú‚îÄ‚îÄ processed      <- The final, canonical data sets for modeling.
‚îÇ   ‚îî‚îÄ‚îÄ raw            <- The original, immutable data dump.
‚îÇ
‚îú‚îÄ‚îÄ docs               <- A default Sphinx project; see sphinx-doc.org for details
‚îÇ
‚îú‚îÄ‚îÄ models             <- Trained and serialized models, model predictions, or model summaries
‚îÇ
‚îú‚îÄ‚îÄ notebooks          <- Jupyter notebooks. Naming convention is a number (for ordering),
‚îÇ                         the creator's initials, and a short `-` delimited description, e.g.
‚îÇ                         `1.0-jqp-initial-data-exploration`.
‚îÇ
‚îú‚îÄ‚îÄ references         <- Data dictionaries, manuals, and all other explanatory materials.
‚îÇ
‚îú‚îÄ‚îÄ reports            <- Generated analysis as HTML, PDF, LaTeX, etc.
‚îÇ   ‚îî‚îÄ‚îÄ figures        <- Generated graphics and figures to be used in reporting
‚îÇ
‚îú‚îÄ‚îÄ requirements.txt   <- The requirements file for reproducing the analysis environment, e.g.
‚îÇ                         generated with `pip freeze > requirements.txt`
‚îÇ
‚îú‚îÄ‚îÄ src                <- Source code for use in this project.
#+END_EXAMPLE

#+BEGIN_SRC sh
mkdir california-house-price
cd california-house-price
mkdir -p references/ reports/figures
touch README.md references/.gitkeep reports/figures/.gitkeep 
git init .; git add *; git commit -m "Let s start"
#+END_SRC
- Organiser le projet

#+BEGIN_EXAMPLE
california-house-price
‚îú‚îÄ‚îÄ Makefile          <- avec des commandes comme `make data` ou `make train`
‚îú‚îÄ‚îÄ README.md         <- Point de d√©part pour un nouvel arrivant sur le projet
‚îú‚îÄ‚îÄ references        <- manuel, pr√©sentations, docs, etc
‚îî‚îÄ‚îÄ reports           <- rapports produit sur le projet, html, latex, pdf, etc 
    ‚îî‚îÄ‚îÄ figures       <- figures produites pour les rapports
#+END_EXAMPLE

#+BEGIN_NOTES
Mais avant de commencer il faut cr√©er un espace de travaille !
#+END_NOTES

** 1. Comprendre le probl√®me
*** Comprendre le probl√®me
*Pourquoi le client a besoin de cette algorithme ?*
#+BEGIN_QUOTE
Le client veut savoir si il a int√©r√™t √† investir dans un quartier. Pour cela il
lui faut le prix m√©dian du quartier.
#+END_QUOTE
*** Comprendre le probl√®me
*Comment cet algorithme sera utilis√© ? Dans quel environnent ?*

#+HTML: <img src="./figures/pipeline.png" align="middle">

*** Comprendre le probl√®me
*Existe t-il une solution actuellement ?*
#+BEGIN_QUOTE
La valeur est estim√©e par des experts ou des r√®gles compliqu√©es.
#+END_QUOTE

#+BEGIN_NOTES
Cela donne une m√©thode de base pour √©valuer notre proposition de nouvelle
m√©thode.
#+END_NOTES

*** Mod√©lisation du probl√®me
*De quelle type d'algorithme d'apprentissage avons nous besoins ?*

#+ATTR_REVEAL: :frag roll-in
*/Machine Learning/ supervis√©:* en particulier il s'agit d'un probl√®me de
r√©gression multiple (/multivariate regression/ en anglais).

*** Choisir la m√©trique d'√©valuation
*√áa d√©pend du probl√®me !*

- Interpr√©table par le client ?
  $$RMSE = \sqrt{\frac{1}{n} \sum_{i =1}^{n} (Y_i - \hat{Y_i})^2}$$
- Plus dure a interpr√©ter mais utile ? 
  $$ R2 = 1 - \frac{\sum_{i =1}^{n} (Y_i - \hat{Y_i})^2}{\sum_{i =1}^{n} (Y_i - \bar{Y})^2} $$

#+BEGIN_NOTES
- La m√©trique d√©pend du probl√®me !
- mais comme c'est avec ca qu'on √©valuation la performance il est tr√®s impotante de
  bien la comprendre ! 
#+END_NOTES
** 2. Rassembler les donn√©es 
*** Quelles donn√©es ?
*Les donn√©es du client ?*

*Des donn√©es publiques ?*
- par exemple la m√©t√©o ?

*Des donn√©es simul√©es ?*
- tr√®s utile pour tester les algorithmes
- peut permettre d'agrandir le jeux de donn√©es

#+BEGIN_NOTES
- Il faut commencer par r√©cup√©rer les donn√©es du client dans le cas de l'exemple
  il s'agit des donn√©es des prix m√©dian ainsi que d'autre statistique sur
  diff√©rent quartier de Californie
- il peut y avoir une diff√©rence de m√©t√©o selon les quartiers 
- Quand l'algorithme devra pr√©dire le prix pour des nouveaux quartiers pourront
  rassembler ces donn√©es ? A quel prix ? Il n'est pas forcement facile d'aller
  r√©cup√©rer les donn√©es m√©t√©o.
#+END_NOTES
*** Quelles donn√©es ?

*donn√©es dynamique ?*
- Consommation √©nerg√©tique d'un b√¢timent

*Pourront nous avoir acc√®s √† ces donn√©es quand l'algorithme sera en production
 ?*
- donn√©es m√©t√©o

*Big data ?*
- donn√©es de log de machine industriel

#+BEGIN_NOTES
Quelques question qu'on peut se poser sur les donn√©es
#+END_NOTES

*** La natures des donn√©es ?
*Donn√©es tabulaires*

*Les donn√©es s√©quentielles*

*Les images*

*Donn√©es textuels*

#+BEGIN_NOTES
A quelle type de donn√©es on est habituellement confront√©s
#+END_NOTES

*** Structure de donn√©es: /DataFrame/

*Stucture de donn√©es*
insert cette image [[https://www.google.com/search?q=dataframe+structure+representation&rlz=1C1GCEA_enFR773FR773&source=lnms&tbm=isch&sa=X&ved=0ahUKEwibo5Wj8tPfAhVD8hQKHW-xCWYQ_AUIDigB&biw=1536&bih=723#imgrc=khvRhkwTvwexiM:][here]]

*Avantage*
- op√©ration classique sur les base donn√©es
- repr√©sentation classique $observations \times features$
- facile a parall√©liser

*Library*
- R: =dplyr=
- python: pandas

#+BEGIN_NOTES
Il existe de nombreux moyen de repr√©sent√© les donn√©es mais pour travailler on
utilise tr√®s souvent des data frame.
#+END_NOTES

*** Structure de donn√©es: /Tensor/

*Structure de donn√©es*
[[https://www.google.com/search?q=tensor+data+structure&rlz=1C1GCEA_enFR773FR773&source=lnms&tbm=isch&sa=X&ved=0ahUKEwjo78_B8tPfAhWbBWMBHZwcB2IQ_AUIDigB&biw=1536&bih=723#imgrc=qe54JoUROxNuyM][get image here]]

*Avantage*
- algorithme fonctionne bien avec ces structure de donn√©es
- parfait pour repr√©senter des images ou des s√©ries temporels
- alg√®bre lin√©aire

*Library*
- =TensorFlow=
- =Numpy=

*** Notre exemple : /California Housing Prices dataset/

#+HTML: <img src="./figures/cal_map.png" align="middle" width=600>

- Donn√©es statique
- /Small data/: ca tient sur un ordinateur

*** Notre exemple : /California Housing Prices dataset/

- Donn√©es accessible en production
#+BEGIN_EXAMPLE
mettre la liste des colonnes
#+END_EXAMPLE

*** Rassembler donn√©es

*Ou ranger les donn√©es ?*
#+BEGIN_EXAMPLE
‚îú‚îÄ‚îÄ data
‚îÇ   ‚îú‚îÄ‚îÄ external       <- Data from third party sources.
‚îÇ   ‚îú‚îÄ‚îÄ interim        <- Intermediate data that has been transformed.
‚îÇ   ‚îú‚îÄ‚îÄ processed      <- The final, canonical data sets for modeling.
‚îÇ   ‚îî‚îÄ‚îÄ raw            <- The original, immutable data dump.
#+END_EXAMPLE

*Versionner*
- git lfs
- git annex
- etc

#+REVEAL: split

*Pourquoi versionner les donn√©es ?*
- Pour reproduire les r√©sultats 
  - garder des donn√©es interm√©diaires pour gagner du temps
- Versionner les mod√®les avec le code
- Pour partager les donn√©es avec les membre de l'√©quipe
#+BEGIN_NOTES
- les mod√®les peuvent √™tre long √† calculer
#+END_NOTES
** 3. D√©couvrir et visualis√© les donn√©es
*** Choisir un langage programmation ?
*R ou python ?*

/les deux/ üòã

*Choisir un paradigme de programmation ?*
- programmation fonctionnel
- programmation orient√©e objet
  
#+BEGIN_NOTES
- si vous vous int√©resser au machine learning, ces deux langages ressorte
- Ce qui est sur c'est qu'a cette √©tape de prototypage il faut pouvoir avancer
  vite, ces deux langage on une grosse communaut√© et des environnements adapt√©
  au machine learning.
- si je devais en choisir un ca serai le R: 
  - communaut√© plus petite et centr√© autour des data science
  - outils de traitement et vizualisation de donn√©es plus puissant
  - language plutot fonctionnel
- une question qu'on se pose jamais c'est le choix de paradigme de programmation
  - pour simplifier ca veut dire coder en suivant quelque r√®gle/habitude
  - pour SIMPLIFIER on peut distinguer deux grands paradigmes, qui sont pas
    forc√©ment disjoint
#+END_NOTES
*** Cr√©er un environnement isol√© et reproductible 
*Pourquoi ?*
- Pour reproduire les r√©sultats
- Facilite la mise en production 

*Exemple d'outils*
- Python =virtualenv=
- =conda=
#+BEGIN_SRC shell
conda create -n california_env python=3.6 numpy pandas scikit-learn 
#+END_SRC

*** Les notebooks
*** Trop de notebooks, tue le notebook
- see notebook war ! 
- quand les utiliser et quand s'arr√™ter !
*** Programmation orient√© objet : en quelques mots
- [[https://www.codenewbie.org/blogs/object-oriented-programming-vs-functional-programming][Object Oriented Programming vs. Functional Programming]]: d√©finitions
- [[https://www.educba.com/functional-programming-vs-oop/][Differences Between Functional Programming vs OOP]]: d√©finitions
*** Programmation orient√© objet : un exemple
Un exemple avec une classe text ? compos√© de mot ? 
*** Programmation orient√© object : design pattern
- parler de element of reusable programing mettre la photo

#+BEGIN_NOTES
- le plus important quand on utilise un paradigme de programmation c'est de
  conna√Ætre les design pattern
  - permet de rentrer vite dans nouveau projet
  - de mieux coder tout simplement
#+END_NOTES
*** Programmation fonctionnelle : en quelque mots
:LOGBOOK:
- Note taken on [2019-01-02 mer. 17:09] \\
  [[http://adv-r.had.co.nz/Functional-programming.html][Advanced R: Functional programming]]
:END:

*Quelques concepts*
- fonction pure: pas d'effet de bord
- fonction de fonction
 
*Pourquoi* 
- plus simple √† parall√©liser
- plus simple √† tester
*** Programmation fonctionnelle : un exemple
*** Programmation fonctionnelle : design pattern
C'est moins clair pour la programmation fonctionnel
Parler de Map reduce
- [[https://www.oreilly.com/library/view/mapreduce-design-patterns/9781449341954/ch01.html][Design Patterns and MapReduce]]
- [[https://en.wikipedia.org/wiki/MapReduce][wikipedia]]
- [[https://fr.wikipedia.org/wiki/MapReduce][wikipedia fr]]: il y a une image
*** Notre exemple : visualisation des donn√©es 
plot page 55
plot page 58
** 4. Cr√©er les mod√®les
*** Cr√©er une strat√©gie d'√©valuation

#+BEGIN_NOTES
Critique ! 
#+END_NOTES
*** Cr√©er des mod√®les

C'est partie pour le code !

#+BEGIN_EXAMPLE
‚îú‚îÄ‚îÄ src                <- Code source *paquag√©*
‚îú‚îÄ‚îÄ models             <- Trained and serialized models, model predictions, or model summaries
#+END_EXAMPLE
- Faire des packages: R et python sont tr√®s bien pour ca
- documenter les fonctions: R: Roxygen, python: docstring

*TDD: Test Driven Development*
- python: =pytest=, R: =testthat=
- c'est plus simple en programmation fonctionnel car pas d'effet de bord

*** √âvaluation des mod√®les par la validation crois√©e
*** Choix d'un mod√®le
*Crit√®res*
- Performance
- Facile √† mettre en production: 
  - je peux l'int√©grer sur la plate-forme de production ?
- Facile √† d√©buguer
  - si le mod√®le donne de mauvais r√©sultats 
- Interpretable
  - je peux comprendre pourquoi cette prediction ? 
*** Notre exemple : 
** 5. D√©ployer le syst√®me
*** D√©ployer le mod√®le

Maintenant qu'on a un mod√®le il faut l'int√©grer dans dans le syst√®me du client !

*Points cl√©s*
- √âvaluer les donn√©es d'entr√©e
- Fournir les pr√©dictions avec les explications si il y en a
- Signaler une divergence du mod√®le
- R√©-entrainer le mod√®le

#+BEGIN_NOTES
- Etape tr√®s d√©pendante de l'environnement du client mais il y a quelque point cl√©e.
#+END_NOTES
*** Architecture orient√©e services
*Concepts*

*** Exemple d'architecture
:LOGBOOK:
- Note taken on [2019-01-04 ven. 10:16] \\
  prendre des images d'ici: https://docs.microsoft.com/en-us/azure/machine-learning/service/how-to-configure-auto-train
:END:
*Exemple: Azure Machine Learning service*

* R√©f√©rences
- https://github.com/drivendata/cookiecutter-data-science
